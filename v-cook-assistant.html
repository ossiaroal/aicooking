<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V-Cook Âé®ÊàøAIÂä©Êâã</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #333;
        }
        
        .container {
            width: 90%;
            max-width: 800px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }
        
        .header {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .avatar {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            border: 3px solid rgba(255, 255, 255, 0.3);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .main-content {
            padding: 30px;
        }
        
        .function-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .function-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .function-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .function-card.recipe {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #333;
        }
        
        .function-card.timer {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #333;
        }
        
        .function-card.safety {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            color: #333;
        }
        
        .function-card.voice {
            background: linear-gradient(135deg, #a8caba 0%, #5d4e75 100%);
            color: white;
        }
        
        .function-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
            display: block;
        }
        
        .function-title {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .function-desc {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        .voice-control {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .voice-button {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            color: white;
            font-size: 2em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 auto 15px;
            display: block;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .voice-button:hover {
            transform: scale(1.1);
        }
        
        .voice-button.listening {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            animation: pulse 1s infinite;
        }
        
        .voice-status {
            font-size: 1.1em;
            color: #666;
            margin-bottom: 10px;
        }
        
        .voice-text {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            min-height: 50px;
            border: 2px dashed #ddd;
            font-style: italic;
            color: #666;
        }
        
        .response-area {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 1.1em;
            line-height: 1.6;
        }
        
        .timer-display {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            display: none;
        }
        
        .timer-time {
            font-size: 3em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-secondary {
            background: #f8f9fa;
            color: #333;
            border: 1px solid #ddd;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .recipe-search {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            display: none;
        }
        
        .search-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1em;
            margin-bottom: 15px;
        }
        
        .recipe-results {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .recipe-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .recipe-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }
        
        .safety-tips {
            background: rgba(255, 107, 107, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            display: none;
        }
        
        .safety-item {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #FF6B6B;
        }
        
        .hidden {
            display: none !important;
        }
        
        .ai-config-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            display: none;
            border: 2px solid #667eea;
        }
        
        .ai-status {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .ai-status.connected {
            background: #d4edda;
            color: #155724;
        }
        
        .ai-status.disconnected {
            background: #f8d7da;
            color: #721c24;
        }
        
        .config-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        
        .config-label {
            font-weight: bold;
            margin-bottom: 5px;
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="avatar">üë®‚Äçüç≥</div>
            <h1>V-Cook</h1>
            <p>ÊÇ®ÁöÑË¥¥ÂøÉÂé®ÊàøAIÂä©Êâã</p>
        </div>
        
        <div class="main-content">
            <!-- ÂäüËÉΩÂç°Áâá -->
            <div class="function-grid">
                <div class="function-card recipe" onclick="toggleRecipe()">
                    <span class="function-icon">üìñ</span>
                    <div class="function-title">ËèúË∞±Êü•ËØ¢</div>
                    <div class="function-desc">ÊêúÁ¥¢ÁæéÂë≥ËèúË∞±</div>
                </div>
                
                <div class="function-card timer" onclick="toggleTimer()">
                    <span class="function-icon">‚è∞</span>
                    <div class="function-title">Âé®ÊàøÂÆöÊó∂</div>
                    <div class="function-desc">ËÆæÁΩÆÁÉπÈ•™ËÆ°Êó∂</div>
                </div>
                
                <div class="function-card safety" onclick="toggleSafety()">
                    <span class="function-icon">üõ°Ô∏è</span>
                    <div class="function-title">ÂÆâÂÖ®ÊèêÈÜí</div>
                    <div class="function-desc">Âé®ÊàøÂÆâÂÖ®Ë¥¥Â£´</div>
                </div>
                
                <div class="function-card voice" onclick="toggleVoice()">
                    <span class="function-icon">üé§</span>
                    <div class="function-title">ËØ≠Èü≥Âä©Êâã</div>
                    <div class="function-desc">ËØ≠Èü≥‰∫§‰∫íÊéßÂà∂</div>
                </div>
            </div>
            
            <!-- AIÈÖçÁΩÆÈù¢Êùø -->
            <div class="ai-config-panel" id="aiConfigPanel">
                <h3>ü§ñ AIÂä©ÊâãÈÖçÁΩÆ</h3>
                <div class="ai-status" id="aiStatus">
                    <span>AIÁä∂ÊÄÅÔºöÊú™ÈÖçÁΩÆ</span>
                    <button class="btn btn-secondary" onclick="toggleAIConfig()">ÈÖçÁΩÆ</button>
                </div>
                
                <div id="aiConfigForm" style="display: none;">
                    <label class="config-label">APIÊèê‰æõÂïÜÔºö</label>
                    <select class="config-input" id="aiProvider">
                        <option value="openai">OpenAI (GPT)</option>
                        <option value="claude">Anthropic (Claude)</option>
                        <option value="gemini">Google (Gemini)</option>
                        <option value="local">Êú¨Âú∞Ê®°Âûã</option>
                    </select>
                    
                    <label class="config-label">APIÂØÜÈí•Ôºö</label>
                    <input type="password" class="config-input" id="aiApiKey" placeholder="ËæìÂÖ•ÊÇ®ÁöÑAPIÂØÜÈí•">
                    
                    <label class="config-label">APIÂú∞ÂùÄÔºö</label>
                    <input type="text" class="config-input" id="aiBaseUrl" placeholder="APIÂü∫Á°ÄURL">
                    
                    <label class="config-label">Ê®°ÂûãÂêçÁß∞Ôºö</label>
                    <input type="text" class="config-input" id="aiModel" placeholder="Ê®°ÂûãÂêçÁß∞">
                    
                    <div style="margin-top: 15px;">
                        <button class="btn btn-primary" onclick="saveAIConfig()">‰øùÂ≠òÈÖçÁΩÆ</button>
                        <button class="btn btn-secondary" onclick="testAIConnection()">ÊµãËØïËøûÊé•</button>
                        <button class="btn btn-secondary" onclick="clearAIConfig()">Ê∏ÖÈô§ÈÖçÁΩÆ</button>
                    </div>
                </div>
            </div>
            
            <!-- ËØ≠Èü≥ÊéßÂà∂Âå∫Âüü -->
            <div class="voice-control">
                <button class="voice-button" id="voiceBtn" onclick="toggleVoiceRecognition()">
                    üé§
                </button>
                <div class="voice-status" id="voiceStatus">ÁÇπÂáªÈ∫¶ÂÖãÈ£éÂºÄÂßãËØ≠Èü≥‰∫§‰∫í</div>
                <div class="voice-text" id="voiceText">ÊÇ®ËØ¥ÁöÑËØù‰ºöÊòæÁ§∫Âú®ËøôÈáå...</div>
            </div>
            
            <!-- ÂìçÂ∫îÂå∫Âüü -->
            <div class="response-area" id="responseArea">
                <div>üëã ÊÇ®Â•ΩÔºÅÊàëÊòØV-CookÔºåÊÇ®ÁöÑË¥¥ÂøÉÂé®ÊàøÂä©Êâã„ÄÇ<br>ÊÇ®ÂèØ‰ª•ÈóÆÊàëËèúË∞±„ÄÅËÆæÁΩÆÂÆöÊó∂Âô®ÔºåÊàñËÄÖËØ¢ÈóÆÂé®ÊàøÂÆâÂÖ®Áü•ËØÜ„ÄÇ</div>
            </div>
            
            <!-- ÂÆöÊó∂Âô® -->
            <div class="timer-display" id="timerDisplay">
                <div class="timer-time" id="timerTime">00:00</div>
                <div>Âé®ÊàøÂÆöÊó∂Âô®</div>
                <div class="timer-controls">
                    <button class="btn btn-secondary" onclick="pauseTimer()">ÊöÇÂÅú</button>
                    <button class="btn btn-secondary" onclick="resetTimer()">ÈáçÁΩÆ</button>
                </div>
            </div>
            
            <!-- ËèúË∞±ÊêúÁ¥¢ -->
            <div class="recipe-search" id="recipeSearch">
                <input type="text" class="search-input" placeholder="ÊêúÁ¥¢ËèúË∞±..." id="recipeInput" onkeyup="searchRecipes()">
                <div class="recipe-results" id="recipeResults">
                    <div class="recipe-item" onclick="showRecipe('Ë•øÁ∫¢ÊüøÁÇíËõã')">
                        <strong>Ë•øÁ∫¢ÊüøÁÇíËõã</strong><br>
                        <small>ÁªèÂÖ∏ÂÆ∂Â∏∏ËèúÔºåÁÆÄÂçïÊòìÂÅö</small>
                    </div>
                    <div class="recipe-item" onclick="showRecipe('Á∫¢ÁÉßËÇâ')">
                        <strong>Á∫¢ÁÉßËÇâ</strong><br>
                        <small>È¶ôÁîúËΩØÁ≥ØÔºåËÄÅÂ∞ëÁöÜÂÆú</small>
                    </div>
                    <div class="recipe-item" onclick="showRecipe('ÂÆ´‰øùÈ∏°‰∏Å')">
                        <strong>ÂÆ´‰øùÈ∏°‰∏Å</strong><br>
                        <small>Â∑ùËèúÁªèÂÖ∏ÔºåÈÖ∏ÁîúÂæÆËæ£</small>
                    </div>
                </div>
            </div>
            
            <!-- ÂÆâÂÖ®ÊèêÈÜí -->
            <div class="safety-tips" id="safetyTips">
                <div class="safety-item">
                    <strong>üî• Áî®ÁÅ´ÂÆâÂÖ®</strong><br>
                    ‰ΩøÁî®ÁáÉÊ∞îÁÅ∂Êó∂ËØ∑Á°Æ‰øùÈÄöÈ£éËâØÂ•ΩÔºåÁ¶ªÂºÄÂé®ÊàøÂâçÂä°ÂøÖÂÖ≥Èó≠ÁÅ´Ê∫ê
                </div>
                <div class="safety-item">
                    <strong>üî™ ÂàÄÂÖ∑ÂÆâÂÖ®</strong><br>
                    ‰ΩøÁî®ÂàÄÂÖ∑Êó∂Ê≥®ÊÑèÊâãÊåá‰ΩçÁΩÆÔºåÂàáËèúÊó∂‰øùÊåÅÂàÄÂÖ∑ÈîãÂà©ÂíåÁ®≥ÂÆö
                </div>
                <div class="safety-item">
                    <strong>üßΩ Ê∏ÖÊ¥ÅÂç´Áîü</strong><br>
                    ÁîüÁÜüÈ£üÂìÅÂàÜÂºÄÂ§ÑÁêÜÔºåÂèäÊó∂Ê∏ÖÊ¥óÈ§êÂÖ∑ÂíåÂ∑•‰ΩúÂè∞Èù¢
                </div>
                <div class="safety-item">
                    <strong>‚ö° ÁîµÂô®ÂÆâÂÖ®</strong><br>
                    ‰ΩøÁî®ÁîµÂô®ÂâçÊ£ÄÊü•ÁîµÁ∫øÊòØÂê¶ÂÆåÂ•ΩÔºåÊπøÊâã‰∏çË¶ÅËß¶Á¢∞ÁîµÂô®ÂºÄÂÖ≥
                </div>
            </div>
        </div>
    </div>
    
    <script>
        class VCookAssistant {
            constructor() {
                this.isListening = false;
                this.recognition = null;
                this.timerInterval = null;
                this.timerSeconds = 0;
                this.timerRunning = false;
                
                // AIÊ®°ÂûãÈÖçÁΩÆ
                this.aiConfig = {
                    // ÂèØ‰ª•ÈÖçÁΩÆ‰∏çÂêåÁöÑAIÊúçÂä°
                    provider: 'openai', // 'openai', 'claude', 'gemini', 'local'
                    apiKey: '', // ÈúÄË¶ÅÁî®Êà∑ÈÖçÁΩÆ
                    baseUrl: 'https://api.openai.com/v1', // APIÂü∫Á°ÄURL
                    model: 'gpt-3.5-turbo' // ‰ΩøÁî®ÁöÑÊ®°Âûã
                };
                
                this.initSpeechRecognition();
                this.initSpeechSynthesis();
                this.initAIConfig();
            }
            
            initAIConfig() {
                // ‰ªélocalStorageËØªÂèñAIÈÖçÁΩÆ
                const savedConfig = localStorage.getItem('vcook-ai-config');
                if (savedConfig) {
                    this.aiConfig = { ...this.aiConfig, ...JSON.parse(savedConfig) };
                }
                
                // Â¶ÇÊûúÊ≤°ÊúâAPIÂØÜÈí•ÔºåÊèêÁ§∫Áî®Êà∑ÈÖçÁΩÆ
                if (!this.aiConfig.apiKey) {
                    this.showAIConfigPrompt();
                }
            }
            
            showAIConfigPrompt() {
                const apiKey = prompt('ËØ∑ËæìÂÖ•ÊÇ®ÁöÑAI APIÂØÜÈí•ÔºàOpenAI/ClaudeÁ≠âÔºâ\n\nÊ≥®ÊÑèÔºöÂØÜÈí•Â∞Ü‰øùÂ≠òÂú®Êú¨Âú∞ÊµèËßàÂô®‰∏≠ÔºåËØ∑Á°Æ‰øùËÆæÂ§áÂÆâÂÖ®„ÄÇ\n\nÂ¶ÇÊûúÊöÇÊó∂‰∏çÈÖçÁΩÆÔºåÂ∞Ü‰ΩøÁî®ÂÜÖÁΩÆÁöÑÂü∫Á°ÄÂäüËÉΩ„ÄÇ');
                if (apiKey && apiKey.trim()) {
                    this.aiConfig.apiKey = apiKey.trim();
                    localStorage.setItem('vcook-ai-config', JSON.stringify(this.aiConfig));
                    this.speak('AIÂäüËÉΩÂ∑≤ÂêØÁî®ÔºåÁé∞Âú®ÂèØ‰ª•‰∏∫ÊÇ®Êèê‰æõÊõ¥Êô∫ËÉΩÁöÑËèúË∞±Êé®ËçêÂíåËØ≠Èü≥ÁêÜËß£ÊúçÂä°ÔºÅ');
                }
            }
            
            initSpeechRecognition() {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    this.recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
                    this.recognition.lang = 'zh-CN';
                    this.recognition.continuous = false;
                    this.recognition.interimResults = false;
                    
                    this.recognition.onstart = () => {
                        this.isListening = true;
                        document.getElementById('voiceBtn').classList.add('listening');
                        document.getElementById('voiceStatus').textContent = 'Ê≠£Âú®ËÅÜÂê¨...';
                    };
                    
                    this.recognition.onresult = (event) => {
                        const transcript = event.results[0][0].transcript;
                        document.getElementById('voiceText').textContent = transcript;
                        this.processVoiceCommand(transcript);
                    };
                    
                    this.recognition.onend = () => {
                        this.isListening = false;
                        document.getElementById('voiceBtn').classList.remove('listening');
                        document.getElementById('voiceStatus').textContent = 'ÁÇπÂáªÈ∫¶ÂÖãÈ£éÂºÄÂßãËØ≠Èü≥‰∫§‰∫í';
                    };
                    
                    this.recognition.onerror = (event) => {
                        console.error('ËØ≠Èü≥ËØÜÂà´ÈîôËØØ:', event.error);
                        this.speak('Êä±Ê≠âÔºåÊàëÊ≤°ÊúâÂê¨Ê∏ÖÊ•öÔºåËØ∑ÂÜçËØ¥‰∏ÄÈÅç');
                    };
                }
            }
            
            initSpeechSynthesis() {
                // ËØ≠Èü≥ÂêàÊàêÂàùÂßãÂåñ
                if ('speechSynthesis' in window) {
                    // Á≠âÂæÖËØ≠Èü≥ÂàóË°®Âä†ËΩΩ
                    speechSynthesis.getVoices();
                }
            }
            
            toggleVoiceRecognition() {
                if (this.isListening) {
                    this.recognition.stop();
                } else {
                    if (this.recognition) {
                        this.recognition.start();
                    } else {
                        this.speak('Êä±Ê≠âÔºåÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅËØ≠Èü≥ËØÜÂà´ÂäüËÉΩ');
                    }
                }
            }
            
            async processVoiceCommand(command) {
                const cmd = command.toLowerCase();
                
                // Â¶ÇÊûúÈÖçÁΩÆ‰∫ÜAIÔºå‰ΩøÁî®AIËøõË°åÊô∫ËÉΩÁêÜËß£
                if (this.aiConfig.apiKey) {
                    await this.handleAICommand(command);
                } else {
                    // ‰ΩøÁî®Âü∫Á°ÄÁöÑÂÖ≥ÈîÆËØçÂåπÈÖç
                    if (cmd.includes('ËèúË∞±') || cmd.includes('ÂÅöËèú') || cmd.includes('ÊÄé‰πàÂÅö')) {
                        this.handleRecipeQuery(command);
                    } else if (cmd.includes('ÂÆöÊó∂') || cmd.includes('ËÆ°Êó∂') || cmd.includes('ÊèêÈÜí')) {
                        this.handleTimerCommand(command);
                    } else if (cmd.includes('ÂÆâÂÖ®') || cmd.includes('Ê≥®ÊÑè') || cmd.includes('Â∞èÂøÉ')) {
                        this.handleSafetyQuery();
                    } else if (cmd.includes('‰Ω†Â•Ω') || cmd.includes('Â∏ÆÂä©')) {
                        this.handleGreeting();
                    } else {
                        this.handleGeneralQuery(command);
                    }
                }
            }
            
            async handleAICommand(command) {
                try {
                    this.updateResponse('ü§ñ Ê≠£Âú®ÊÄùËÄÉ‰∏≠...');
                    
                    const response = await this.callAI(command);
                    this.updateResponse(response);
                    this.speak(response);
                    
                    // Ê†πÊçÆAIÂìçÂ∫îÊâßË°åÁõ∏Â∫îÊìç‰Ωú
                    this.executeAIResponse(response, command);
                } catch (error) {
                    console.error('AIË∞ÉÁî®Â§±Ë¥•:', error);
                    this.updateResponse('Êä±Ê≠âÔºåAIÊúçÂä°ÊöÇÊó∂‰∏çÂèØÁî®Ôºå‰∏∫ÊÇ®ÂàáÊç¢Âà∞Âü∫Á°ÄÂäüËÉΩÊ®°Âºè„ÄÇ');
                    this.speak('AIÊúçÂä°ÊöÇÊó∂‰∏çÂèØÁî®Ôºå‰∏∫ÊÇ®ÂàáÊç¢Âà∞Âü∫Á°ÄÂäüËÉΩ');
                    
                    // ÈôçÁ∫ßÂà∞Âü∫Á°ÄÂäüËÉΩ
                    const cmd = command.toLowerCase();
                    if (cmd.includes('ËèúË∞±') || cmd.includes('ÂÅöËèú') || cmd.includes('ÊÄé‰πàÂÅö')) {
                        this.handleRecipeQuery(command);
                    } else if (cmd.includes('ÂÆöÊó∂') || cmd.includes('ËÆ°Êó∂') || cmd.includes('ÊèêÈÜí')) {
                        this.handleTimerCommand(command);
                    } else {
                        this.handleGeneralQuery(command);
                    }
                }
            }
            
            async callAI(userMessage) {
                const systemPrompt = `‰Ω†ÊòØV-CookÔºå‰∏Ä‰∏™Ë¥¥ÂøÉÁöÑÂé®ÊàøAIÂä©Êâã„ÄÇ‰Ω†ÁöÑËÅåË¥£ÊòØÔºö
1. Êèê‰æõËØ¶ÁªÜÁöÑËèúË∞±ÂíåÁÉπÈ•™ÊåáÂØº
2. Â∏ÆÂä©Áî®Êà∑ËÆæÁΩÆÂé®ÊàøÂÆöÊó∂Âô®
3. Êèê‰æõÂé®ÊàøÂÆâÂÖ®Âª∫ËÆÆ
4. ÂõûÁ≠îÁÉπÈ•™Áõ∏ÂÖ≥ÈóÆÈ¢ò

ËØ∑Áî®Ê∏©Âíå„ÄÅ‰∏ì‰∏öÁöÑËØ≠Ë∞ÉÂõûÁ≠îÔºå‰øùÊåÅÁÆÄÊ¥Å‰ΩÜÊúâÁî®„ÄÇÂ¶ÇÊûúÁî®Êà∑ËØ¢ÈóÆËèúË∞±ÔºåËØ∑Êèê‰æõÂÖ∑‰ΩìÁöÑÈ£üÊùêÂíåÊ≠•È™§„ÄÇÂ¶ÇÊûúÁî®Êà∑Ë¶ÅËÆæÁΩÆÂÆöÊó∂Âô®ÔºåËØ∑ËØÜÂà´Êó∂Èó¥Âπ∂Á°ÆËÆ§„ÄÇ

ÂΩìÂâçÁî®Êà∑ËØ¥Ôºö"${userMessage}"

ËØ∑ÂàÜÊûêÁî®Êà∑ÊÑèÂõæÂπ∂ÁªôÂá∫ÂêàÈÄÇÁöÑÂõûÂ∫î„ÄÇÂ¶ÇÊûúÊòØËèúË∞±Êü•ËØ¢ÔºåËØ∑Êèê‰æõËØ¶ÁªÜÂÅöÊ≥ï„ÄÇÂ¶ÇÊûúÊòØÂÆöÊó∂ÈúÄÊ±ÇÔºåËØ∑Á°ÆËÆ§Êó∂Èó¥„ÄÇ`;
                
                const requestBody = {
                    model: this.aiConfig.model,
                    messages: [
                        {
                            role: 'system',
                            content: systemPrompt
                        },
                        {
                            role: 'user',
                            content: userMessage
                        }
                    ],
                    max_tokens: 500,
                    temperature: 0.7
                };
                
                const response = await fetch(`${this.aiConfig.baseUrl}/chat/completions`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${this.aiConfig.apiKey}`
                    },
                    body: JSON.stringify(requestBody)
                });
                
                if (!response.ok) {
                    throw new Error(`APIËØ∑Ê±ÇÂ§±Ë¥•: ${response.status}`);
                }
                
                const data = await response.json();
                return data.choices[0].message.content.trim();
            }
            
            executeAIResponse(response, originalCommand) {
                // Ê£ÄÊü•AIÂìçÂ∫î‰∏≠ÊòØÂê¶ÂåÖÂê´ÂÆöÊó∂Âô®ËÆæÁΩÆ
                const timerMatch = response.match(/(\d+)ÂàÜÈíü|(\d+)Áßí/);
                if (timerMatch && originalCommand.includes('ÂÆöÊó∂')) {
                    let seconds = 0;
                    if (timerMatch[1]) {
                        seconds = parseInt(timerMatch[1]) * 60;
                    } else if (timerMatch[2]) {
                        seconds = parseInt(timerMatch[2]);
                    }
                    if (seconds > 0) {
                        this.startTimer(seconds);
                    }
                }
                
                // Ê£ÄÊü•ÊòØÂê¶ÊòØËèúË∞±Êü•ËØ¢ÔºåÊòæÁ§∫ËèúË∞±ÊêúÁ¥¢Èù¢Êùø
                if (originalCommand.includes('ËèúË∞±') || originalCommand.includes('ÂÅöËèú') || originalCommand.includes('ÊÄé‰πàÂÅö')) {
                    document.getElementById('recipeSearch').style.display = 'block';
                }
                
                // Ê£ÄÊü•ÊòØÂê¶ÊòØÂÆâÂÖ®Êü•ËØ¢ÔºåÊòæÁ§∫ÂÆâÂÖ®ÊèêÈÜí
                if (originalCommand.includes('ÂÆâÂÖ®') || response.includes('ÂÆâÂÖ®')) {
                    document.getElementById('safetyTips').style.display = 'block';
                }
            }
            
            handleRecipeQuery(command) {
                let response = '';
                
                if (command.includes('Ë•øÁ∫¢ÊüøÁÇíËõã')) {
                    response = 'Ë•øÁ∫¢ÊüøÁÇíËõãÁöÑÂÅöÊ≥ïÔºöÂÖàÂ∞ÜÈ∏°ËõãÊâìÊï£ÁÇíÁÜüÁõõËµ∑ÔºåÂÜçÁÇíË•øÁ∫¢ÊüøÂá∫Ê±ÅÔºåÊúÄÂêéÂÄíÂÖ•È∏°ËõãÁøªÁÇíÂç≥ÂèØ„ÄÇËÆ∞ÂæóÂÖàÊîæÁ≥ñÂÜçÊîæÁõêÂì¶ÔºÅ';
                } else if (command.includes('Á∫¢ÁÉßËÇâ')) {
                    response = 'Á∫¢ÁÉßËÇâÈúÄË¶Å‰∫îËä±ËÇâ„ÄÅÂÜ∞Á≥ñ„ÄÅÁîüÊäΩ„ÄÅËÄÅÊäΩ„ÄÇÂÖàÁÑØÊ∞¥ÔºåÂÜçÁÇíÁ≥ñËâ≤ÔºåÂ∞èÁÅ´ÊÖ¢ÁÇñ‰∏ÄÂ∞èÊó∂„ÄÇËÆ∞Âæó‰∏≠ÈÄîÁøªÈù¢ÔºåÊúÄÂêéÂ§ßÁÅ´Êî∂Ê±Å„ÄÇ';
                } else {
                    response = 'Êàë‰∏∫ÊÇ®Êé®ËçêÂá†ÈÅìÂÆ∂Â∏∏ËèúÔºöË•øÁ∫¢ÊüøÁÇíËõã„ÄÅÁ∫¢ÁÉßËÇâ„ÄÅÂÆ´‰øùÈ∏°‰∏Å„ÄÇÊÇ®ÊÉ≥‰∫ÜËß£Âì™ÈÅìËèúÁöÑÂÖ∑‰ΩìÂÅöÊ≥ïÂë¢Ôºü';
                }
                
                this.updateResponse(response);
                this.speak(response);
                document.getElementById('recipeSearch').style.display = 'block';
            }
            
            handleTimerCommand(command) {
                const timeMatch = command.match(/(\d+)ÂàÜÈíü?|(\d+)Áßí/);
                
                if (timeMatch) {
                    let seconds = 0;
                    if (timeMatch[1]) {
                        seconds = parseInt(timeMatch[1]) * 60;
                    } else if (timeMatch[2]) {
                        seconds = parseInt(timeMatch[2]);
                    }
                    
                    this.startTimer(seconds);
                    const response = `Â•ΩÁöÑÔºåÊàë‰∏∫ÊÇ®ËÆæÁΩÆ‰∫Ü${Math.floor(seconds/60)}ÂàÜÈíü${seconds%60}ÁßíÁöÑÂÆöÊó∂Âô®`;
                    this.updateResponse(response);
                    this.speak(response);
                } else {
                    const response = 'ËØ∑ÂëäËØâÊàëÈúÄË¶ÅÂÆöÊó∂Â§öÈïøÊó∂Èó¥ÔºåÊØîÂ¶Ç"ÂÆöÊó∂5ÂàÜÈíü"';
                    this.updateResponse(response);
                    this.speak(response);
                }
            }
            
            handleSafetyQuery() {
                const response = 'Âé®ÊàøÂÆâÂÖ®ÂæàÈáçË¶ÅÔºÅËØ∑Ê≥®ÊÑèÁî®ÁÅ´ÂÆâÂÖ®„ÄÅÂàÄÂÖ∑‰ΩøÁî®„ÄÅ‰øùÊåÅÊ∏ÖÊ¥ÅÂç´ÁîüÔºåËøòË¶ÅÊ≥®ÊÑèÁîµÂô®ÂÆâÂÖ®„ÄÇÊàëÂ∑≤‰∏∫ÊÇ®ÊòæÁ§∫ËØ¶ÁªÜÁöÑÂÆâÂÖ®ÊèêÈÜí„ÄÇ';
                this.updateResponse(response);
                this.speak(response);
                document.getElementById('safetyTips').style.display = 'block';
            }
            
            handleGreeting() {
                const responses = [
                    'ÊÇ®Â•ΩÔºÅÊàëÊòØV-CookÔºåÂæàÈ´òÂÖ¥‰∏∫ÊÇ®ÊúçÂä°„ÄÇ‰ªäÂ§©ÊÉ≥ÂÅö‰ªÄ‰πàÁæéÈ£üÂë¢Ôºü',
                    'Ê¨¢Ëøé‰ΩøÁî®V-CookÂé®ÊàøÂä©ÊâãÔºÅÊàëÂèØ‰ª•Â∏ÆÊÇ®Êü•ËèúË∞±„ÄÅËÆæÂÆöÊó∂Âô®„ÄÅÊèêÈÜíÂÆâÂÖ®‰∫ãÈ°π„ÄÇ',
                    'ÊÇ®Â•ΩÔºÅ‰Ωú‰∏∫ÊÇ®ÁöÑÂé®Êàø‰ºô‰º¥ÔºåÊàëÈöèÊó∂ÂáÜÂ§á‰∏∫ÊÇ®Êèê‰æõÁÉπÈ•™Â∏ÆÂä©„ÄÇ'
                ];
                const response = responses[Math.floor(Math.random() * responses.length)];
                this.updateResponse(response);
                this.speak(response);
            }
            
            handleGeneralQuery(command) {
                const response = 'ÊàëÊòØÊÇ®ÁöÑÂé®ÊàøÂä©ÊâãV-Cook„ÄÇÊÇ®ÂèØ‰ª•ÈóÆÊàëËèúË∞±ÂÅöÊ≥ï„ÄÅËÆæÁΩÆÂÆöÊó∂Âô®ÔºåÊàñËÄÖ‰∫ÜËß£Âé®ÊàøÂÆâÂÖ®Áü•ËØÜ„ÄÇËøòÊúâ‰ªÄ‰πàÊàëÂèØ‰ª•Â∏ÆÊÇ®ÁöÑÂêóÔºü';
                this.updateResponse(response);
                this.speak(response);
            }
            
            updateResponse(text) {
                document.getElementById('responseArea').innerHTML = `<div>ü§ñ ${text}</div>`;
            }
            
            speak(text) {
                if ('speechSynthesis' in window) {
                    // ÂÅúÊ≠¢ÂΩìÂâçÊí≠Êîæ
                    speechSynthesis.cancel();
                    
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = 'zh-CN';
                    utterance.rate = 0.8;
                    utterance.pitch = 1.1;
                    utterance.volume = 0.9;
                    
                    // ÈÄâÊã©ÂêàÈÄÇÁöÑËØ≠Èü≥
                    const voices = speechSynthesis.getVoices();
                    const preferredVoices = voices.filter(voice => 
                        voice.lang.includes('zh') && 
                        (voice.name.includes('Â•≥') || voice.name.includes('Female'))
                    );
                    
                    if (preferredVoices.length > 0) {
                        utterance.voice = preferredVoices[0];
                    }
                    
                    speechSynthesis.speak(utterance);
                }
            }
            
            startTimer(seconds) {
                this.timerSeconds = seconds;
                this.timerRunning = true;
                document.getElementById('timerDisplay').style.display = 'block';
                
                this.timerInterval = setInterval(() => {
                    if (this.timerRunning && this.timerSeconds > 0) {
                        this.timerSeconds--;
                        this.updateTimerDisplay();
                        
                        if (this.timerSeconds === 0) {
                            this.timerComplete();
                        }
                    }
                }, 1000);
                
                this.updateTimerDisplay();
            }
            
            updateTimerDisplay() {
                const minutes = Math.floor(this.timerSeconds / 60);
                const seconds = this.timerSeconds % 60;
                document.getElementById('timerTime').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            timerComplete() {
                this.timerRunning = false;
                clearInterval(this.timerInterval);
                this.speak('Êó∂Èó¥Âà∞‰∫ÜÔºÅËØ∑Ê≥®ÊÑèÊü•ÁúãÊÇ®ÁöÑËèúÂìÅ„ÄÇ');
                this.updateResponse('‚è∞ ÂÆöÊó∂Âô®Êó∂Èó¥Âà∞‰∫ÜÔºÅËØ∑ÂèäÊó∂Â§ÑÁêÜÊÇ®ÁöÑËèúÂìÅ„ÄÇ');
                
                // Èó™ÁÉÅÊèêÈÜí
                const timerDisplay = document.getElementById('timerDisplay');
                timerDisplay.style.animation = 'pulse 0.5s infinite';
                
                setTimeout(() => {
                    timerDisplay.style.animation = '';
                }, 5000);
            }
            
            pauseTimer() {
                this.timerRunning = !this.timerRunning;
                const btn = event.target;
                btn.textContent = this.timerRunning ? 'ÊöÇÂÅú' : 'ÁªßÁª≠';
            }
            
            resetTimer() {
                this.timerRunning = false;
                this.timerSeconds = 0;
                clearInterval(this.timerInterval);
                document.getElementById('timerDisplay').style.display = 'none';
            }
            
            async searchRecipesWithAI(query) {
                const systemPrompt = `‰Ω†ÊòØ‰∏Ä‰∏™‰∏ì‰∏öÁöÑÂé®Â∏àÂä©Êâã„ÄÇÁî®Êà∑ÊêúÁ¥¢ËèúË∞±ÂÖ≥ÈîÆËØçÔºö"${query}"„ÄÇ
                
ËØ∑‰∏∫Áî®Êà∑Êé®Ëçê3-5‰∏™Áõ∏ÂÖ≥ÁöÑËèúË∞±ÔºåÊØè‰∏™ËèúË∞±ÂåÖÂê´Ôºö
1. ËèúÂêç
2. ÁÆÄÁü≠ÊèèËø∞Ôºà‰∏ÄÂè•ËØùÔºâ
3. ‰∏ªË¶ÅÁâπÁÇπ

ËØ∑‰ª•JSONÊ†ºÂºèËøîÂõûÔºåÊ†ºÂºèÂ¶Ç‰∏ãÔºö
[
  {"name": "ËèúÂêç", "desc": "ÁÆÄÁü≠ÊèèËø∞", "difficulty": "ÈöæÂ∫¶Á≠âÁ∫ß"},
  ...
]

Âè™ËøîÂõûJSONÊï∞ÊçÆÔºå‰∏çË¶ÅÂÖ∂‰ªñÊñáÂ≠ó„ÄÇ`;
                
                const requestBody = {
                    model: this.aiConfig.model,
                    messages: [
                        {
                            role: 'system',
                            content: systemPrompt
                        }
                    ],
                    max_tokens: 400,
                    temperature: 0.7
                };
                
                const response = await fetch(`${this.aiConfig.baseUrl}/chat/completions`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${this.aiConfig.apiKey}`
                    },
                    body: JSON.stringify(requestBody)
                });
                
                if (!response.ok) {
                    throw new Error(`APIËØ∑Ê±ÇÂ§±Ë¥•: ${response.status}`);
                }
                
                const data = await response.json();
                const aiResponse = data.choices[0].message.content.trim();
                
                try {
                    // Â∞ùËØïËß£ÊûêJSON
                    const recipes = JSON.parse(aiResponse);
                    return recipes.map(recipe => 
                        `<div class="recipe-item" onclick="showRecipe('${recipe.name}', true)">
                            <strong>${recipe.name}</strong><br>
                            <small>${recipe.desc} - ${recipe.difficulty || '‰∏≠Á≠âÈöæÂ∫¶'}</small>
                        </div>`
                    ).join('');
                } catch (parseError) {
                    // Â¶ÇÊûúJSONËß£ÊûêÂ§±Ë¥•ÔºåËøîÂõûÊñáÊú¨Ê†ºÂºè
                    return `<div class="recipe-item">
                        <strong>AIÊé®Ëçê</strong><br>
                        <small>${aiResponse}</small>
                    </div>`;
                }
            }
            
            async getRecipeDetailsWithAI(recipeName) {
                const systemPrompt = `ËØ∑Êèê‰æõ"${recipeName}"ËøôÈÅìËèúÁöÑËØ¶ÁªÜÂÅöÊ≥ïÔºåÂåÖÊã¨Ôºö
1. ÊâÄÈúÄÈ£üÊùêÔºàÂÖ∑‰ΩìÁî®ÈáèÔºâ
2. Âà∂‰ΩúÊ≠•È™§ÔºàËØ¶ÁªÜÊ≠•È™§Ôºâ
3. ÁÉπÈ•™ÊäÄÂ∑ßÂíåÊ≥®ÊÑè‰∫ãÈ°π

ËØ∑Áî®ÁÆÄÊ¥ÅÊòé‰∫ÜÁöÑ‰∏≠ÊñáÂõûÁ≠îÔºåÈÄÇÂêàÂÆ∂Â∫≠Âà∂‰Ωú„ÄÇ`;
                
                const requestBody = {
                    model: this.aiConfig.model,
                    messages: [
                        {
                            role: 'system',
                            content: systemPrompt
                        }
                    ],
                    max_tokens: 600,
                    temperature: 0.7
                };
                
                const response = await fetch(`${this.aiConfig.baseUrl}/chat/completions`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${this.aiConfig.apiKey}`
                    },
                    body: JSON.stringify(requestBody)
                });
                
                if (!response.ok) {
                    throw new Error(`APIËØ∑Ê±ÇÂ§±Ë¥•: ${response.status}`);
                }
                
                const data = await response.json();
                return data.choices[0].message.content.trim();
            }
        }
        
        // ÂÖ®Â±ÄÂèòÈáè
        let vCook;
        
        // ÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', () => {
            vCook = new VCookAssistant();
        });
        
        // ÂÖ®Â±ÄÂáΩÊï∞
        function toggleVoiceRecognition() {
            vCook.toggleVoiceRecognition();
        }
        
        function toggleRecipe() {
            const recipeSearch = document.getElementById('recipeSearch');
            const isVisible = recipeSearch.style.display === 'block';
            
            // ÈöêËóèÂÖ∂‰ªñÈù¢Êùø
            document.getElementById('safetyTips').style.display = 'none';
            
            recipeSearch.style.display = isVisible ? 'none' : 'block';
            
            if (!isVisible) {
                vCook.updateResponse('üìñ ËèúË∞±Êü•ËØ¢Â∑≤ÊâìÂºÄÔºåÊÇ®ÂèØ‰ª•ÊêúÁ¥¢ÊàñÊµèËßàÊé®ËçêËèúË∞±„ÄÇ');
                vCook.speak('ËèúË∞±Êü•ËØ¢Â∑≤ÊâìÂºÄ');
            }
        }
        
        function toggleTimer() {
            vCook.updateResponse('‚è∞ ËØ∑ÈÄöËøáËØ≠Èü≥ÂëäËØâÊàëÈúÄË¶ÅÂÆöÊó∂Â§öÈïøÊó∂Èó¥ÔºåÊØîÂ¶ÇËØ¥"ÂÆöÊó∂5ÂàÜÈíü"„ÄÇ');
            vCook.speak('ËØ∑ÂëäËØâÊàëÈúÄË¶ÅÂÆöÊó∂Â§öÈïøÊó∂Èó¥');
        }
        
        function toggleSafety() {
            const safetyTips = document.getElementById('safetyTips');
            const isVisible = safetyTips.style.display === 'block';
            
            // ÈöêËóèÂÖ∂‰ªñÈù¢Êùø
            document.getElementById('recipeSearch').style.display = 'none';
            
            safetyTips.style.display = isVisible ? 'none' : 'block';
            
            if (!isVisible) {
                vCook.updateResponse('üõ°Ô∏è Âé®ÊàøÂÆâÂÖ®ÊèêÈÜíÂ∑≤ÊòæÁ§∫ÔºåËØ∑Ê≥®ÊÑèËøô‰∫õÈáçË¶ÅÁöÑÂÆâÂÖ®‰∫ãÈ°π„ÄÇ');
                vCook.speak('ËØ∑Ê≥®ÊÑèÂé®ÊàøÂÆâÂÖ®‰∫ãÈ°π');
            }
        }
        
        function toggleVoice() {
            vCook.updateResponse('üé§ ËØ≠Èü≥Âä©ÊâãÂ∑≤ÊøÄÊ¥ªÔºåÁÇπÂáªÈ∫¶ÂÖãÈ£éÊåâÈíÆÂºÄÂßãËØ≠Èü≥‰∫§‰∫í„ÄÇ');
            vCook.speak('ËØ∑ÁÇπÂáªÈ∫¶ÂÖãÈ£éÂºÄÂßãËØ≠Èü≥‰∫§‰∫í');
        }
        
        async function searchRecipes() {
            const query = document.getElementById('recipeInput').value.toLowerCase();
            const results = document.getElementById('recipeResults');
            
            if (query.length === 0) {
                results.innerHTML = `
                    <div class="recipe-item" onclick="showRecipe('Ë•øÁ∫¢ÊüøÁÇíËõã')">
                        <strong>Ë•øÁ∫¢ÊüøÁÇíËõã</strong><br>
                        <small>ÁªèÂÖ∏ÂÆ∂Â∏∏ËèúÔºåÁÆÄÂçïÊòìÂÅö</small>
                    </div>
                    <div class="recipe-item" onclick="showRecipe('Á∫¢ÁÉßËÇâ')">
                        <strong>Á∫¢ÁÉßËÇâ</strong><br>
                        <small>È¶ôÁîúËΩØÁ≥ØÔºåËÄÅÂ∞ëÁöÜÂÆú</small>
                    </div>
                    <div class="recipe-item" onclick="showRecipe('ÂÆ´‰øùÈ∏°‰∏Å')">
                        <strong>ÂÆ´‰øùÈ∏°‰∏Å</strong><br>
                        <small>Â∑ùËèúÁªèÂÖ∏ÔºåÈÖ∏ÁîúÂæÆËæ£</small>
                    </div>
                `;
                return;
            }
            
            // Â¶ÇÊûúÈÖçÁΩÆ‰∫ÜAIÔºå‰ΩøÁî®AIÊêúÁ¥¢ËèúË∞±
            if (vCook.aiConfig.apiKey) {
                try {
                    results.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">ü§ñ AIÊ≠£Âú®‰∏∫ÊÇ®ÊêúÁ¥¢ËèúË∞±...</div>';
                    
                    const aiRecipes = await vCook.searchRecipesWithAI(query);
                    results.innerHTML = aiRecipes;
                } catch (error) {
                    console.error('AIËèúË∞±ÊêúÁ¥¢Â§±Ë¥•:', error);
                    // ÈôçÁ∫ßÂà∞Âü∫Á°ÄÊêúÁ¥¢
                    basicRecipeSearch(query, results);
                }
            } else {
                // ‰ΩøÁî®Âü∫Á°ÄÊêúÁ¥¢
                basicRecipeSearch(query, results);
            }
        }
        
        function basicRecipeSearch(query, results) {
            // ÁÆÄÂçïÁöÑÊêúÁ¥¢ÈÄªËæë
            const recipes = [
                { name: 'Ë•øÁ∫¢ÊüøÁÇíËõã', desc: 'ÁªèÂÖ∏ÂÆ∂Â∏∏ËèúÔºåÁÆÄÂçïÊòìÂÅö' },
                { name: 'Á∫¢ÁÉßËÇâ', desc: 'È¶ôÁîúËΩØÁ≥ØÔºåËÄÅÂ∞ëÁöÜÂÆú' },
                { name: 'ÂÆ´‰øùÈ∏°‰∏Å', desc: 'Â∑ùËèúÁªèÂÖ∏ÔºåÈÖ∏ÁîúÂæÆËæ£' },
                { name: 'È∫ªÂ©ÜË±ÜËÖê', desc: 'Â∑ùËèú‰ª£Ë°®ÔºåÈ∫ªËæ£È≤úÈ¶ô' },
                { name: 'Á≥ñÈÜãÈáåËÑä', desc: 'ÈÖ∏ÁîúÂèØÂè£ÔºåËÄÅÂ∞ëÁöÜÂÆú' },
                { name: 'ÈùíÊ§íËÇâ‰∏ù', desc: 'ÂÆ∂Â∏∏Â∞èÁÇíÔºåËê•ÂÖª‰∏∞ÂØå' }
            ];
            
            const filtered = recipes.filter(recipe => 
                recipe.name.includes(query) || recipe.desc.includes(query)
            );
            
            if (filtered.length === 0) {
                results.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">Ê≤°ÊúâÊâæÂà∞Áõ∏ÂÖ≥ËèúË∞±</div>';
            } else {
                results.innerHTML = filtered.map(recipe => 
                    `<div class="recipe-item" onclick="showRecipe('${recipe.name}')">
                        <strong>${recipe.name}</strong><br>
                        <small>${recipe.desc}</small>
                    </div>`
                ).join('');
            }
        }
        
        async function showRecipe(recipeName, useAI = false) {
            if (useAI && vCook.aiConfig.apiKey) {
                try {
                    vCook.updateResponse('ü§ñ Ê≠£Âú®‰∏∫ÊÇ®Êü•ÊâæËØ¶ÁªÜËèúË∞±...');
                    const aiRecipe = await vCook.getRecipeDetailsWithAI(recipeName);
                    vCook.updateResponse(`üìñ ${recipeName}Ôºö\n\n${aiRecipe}`);
                    vCook.speak(`${recipeName}ÁöÑËØ¶ÁªÜÂÅöÊ≥ïÂ∑≤‰∏∫ÊÇ®ÊòæÁ§∫`);
                } catch (error) {
                    console.error('AIËèúË∞±ËØ¶ÊÉÖËé∑ÂèñÂ§±Ë¥•:', error);
                    // ÈôçÁ∫ßÂà∞Âü∫Á°ÄËèúË∞±
                    showBasicRecipe(recipeName);
                }
            } else {
                showBasicRecipe(recipeName);
            }
        }
        
        function showBasicRecipe(recipeName) {
            const recipes = {
                'Ë•øÁ∫¢ÊüøÁÇíËõã': 'Ë•øÁ∫¢ÊüøÁÇíËõãÂÅöÊ≥ïÔºö1.È∏°ËõãÊâìÊï£Âä†ÁõêÔºåÁÉ≠Ê≤πÁÇíÁÜüÁõõËµ∑ 2.Ë•øÁ∫¢ÊüøÂàáÂùóÁÇíÂá∫Ê±ÅÊ∞¥ 3.ÂÄíÂÖ•È∏°ËõãÁøªÁÇíÔºåË∞ÉÂë≥Âç≥ÂèØ',
                'Á∫¢ÁÉßËÇâ': 'Á∫¢ÁÉßËÇâÂÅöÊ≥ïÔºö1.‰∫îËä±ËÇâÂàáÂùóÁÑØÊ∞¥ 2.ÁÇíÁ≥ñËâ≤Ëá≥ÁÑ¶Á≥ñËâ≤ 3.‰∏ãËÇâÂùóÁÇíÂåÄ 4.Âä†Ë∞ÉÊñôÂíåÊ∞¥ÔºåÂ∞èÁÅ´ÁÇñ1Â∞èÊó∂ 5.Â§ßÁÅ´Êî∂Ê±Å',
                'ÂÆ´‰øùÈ∏°‰∏Å': 'ÂÆ´‰øùÈ∏°‰∏ÅÂÅöÊ≥ïÔºö1.È∏°ËÉ∏ËÇâÂàá‰∏ÅËÖåÂà∂ 2.Ëä±ÁîüÁ±≥ÁÇ∏ÁÜü 3.ÁàÜÁÇíÈ∏°‰∏ÅËá≥ÂèòËâ≤ 4.‰∏ãÂπ≤Ëæ£Ê§íËä±Ê§íÁàÜÈ¶ô 5.Ë∞ÉÂë≥ÁÇíÂåÄÂç≥ÂèØ',
                'È∫ªÂ©ÜË±ÜËÖê': 'È∫ªÂ©ÜË±ÜËÖêÂÅöÊ≥ïÔºö1.Ë±ÜËÖêÂàáÂùóÁÑØÊ∞¥ 2.ÁÇíËÇâÊú´Ëá≥ÈÖ•È¶ô 3.‰∏ãË±ÜÁì£ÈÖ±ÁÇíÁ∫¢Ê≤π 4.Âä†Ë±ÜËÖêÂíåË∞ÉÊñôÁÉßÂà∂ 5.ÂãæËä°ÊííËä±Ê§íÈù¢',
                'Á≥ñÈÜãÈáåËÑä': 'Á≥ñÈÜãÈáåËÑäÂÅöÊ≥ïÔºö1.ÈáåËÑäËÇâÂàáÊù°ËÖåÂà∂ 2.Ë£πÊ∑ÄÁ≤âÁÇ∏Ëá≥ÈáëÈªÑ 3.Ë∞ÉÁ≥ñÈÜãÊ±Å 4.ÁÇíÁ≥ñÈÜãÊ±ÅËá≥ÊµìÁ®† 5.ÂÄíÂÖ•ÈáåËÑäÁÇíÂåÄ',
                'ÈùíÊ§íËÇâ‰∏ù': 'ÈùíÊ§íËÇâ‰∏ùÂÅöÊ≥ïÔºö1.ËÇâ‰∏ùËÖåÂà∂ 2.ÈùíÊ§íÂàá‰∏ù 3.ÁÉ≠Ê≤πÁÇíËÇâ‰∏ùËá≥ÂèòËâ≤ 4.‰∏ãÈùíÊ§í‰∏ùÁÇíÊñ≠Áîü 5.Ë∞ÉÂë≥ÁÇíÂåÄÂç≥ÂèØ'
            };
            
            const recipe = recipes[recipeName] || 'Êä±Ê≠âÔºåÊöÇÊó∂Ê≤°ÊúâËøôÈÅìËèúÁöÑËØ¶ÁªÜÂÅöÊ≥ï„ÄÇ';
            vCook.updateResponse(`üìñ ${recipeName}Ôºö${recipe}`);
            vCook.speak(`${recipeName}ÁöÑÂÅöÊ≥ïÂ∑≤‰∏∫ÊÇ®ÊòæÁ§∫`);
        }
        
        function pauseTimer() {
            vCook.pauseTimer();
        }
        
        function resetTimer() {
            vCook.resetTimer();
        }
        
        function toggleAIConfig() {
            const panel = document.getElementById('aiConfigPanel');
            const form = document.getElementById('aiConfigForm');
            const isVisible = panel.style.display === 'block';
            
            panel.style.display = isVisible ? 'none' : 'block';
            
            if (!isVisible) {
                // Âä†ËΩΩÂΩìÂâçÈÖçÁΩÆ
                loadAIConfigToForm();
                updateAIStatus();
            }
        }
        
        function loadAIConfigToForm() {
            document.getElementById('aiProvider').value = vCook.aiConfig.provider;
            document.getElementById('aiApiKey').value = vCook.aiConfig.apiKey;
            document.getElementById('aiBaseUrl').value = vCook.aiConfig.baseUrl;
            document.getElementById('aiModel').value = vCook.aiConfig.model;
        }
        
        function saveAIConfig() {
            const provider = document.getElementById('aiProvider').value;
            const apiKey = document.getElementById('aiApiKey').value;
            const baseUrl = document.getElementById('aiBaseUrl').value;
            const model = document.getElementById('aiModel').value;
            
            // Ê†πÊçÆÊèê‰æõÂïÜËÆæÁΩÆÈªòËÆ§ÂÄº
            let finalBaseUrl = baseUrl;
            let finalModel = model;
            
            if (!baseUrl) {
                switch (provider) {
                    case 'openai':
                        finalBaseUrl = 'https://api.openai.com/v1';
                        break;
                    case 'claude':
                        finalBaseUrl = 'https://api.anthropic.com';
                        break;
                    case 'gemini':
                        finalBaseUrl = 'https://generativelanguage.googleapis.com/v1';
                        break;
                    case 'local':
                        finalBaseUrl = 'http://localhost:11434/v1';
                        break;
                }
            }
            
            if (!model) {
                switch (provider) {
                    case 'openai':
                        finalModel = 'gpt-3.5-turbo';
                        break;
                    case 'claude':
                        finalModel = 'claude-3-haiku-20240307';
                        break;
                    case 'gemini':
                        finalModel = 'gemini-pro';
                        break;
                    case 'local':
                        finalModel = 'llama2';
                        break;
                }
            }
            
            vCook.aiConfig = {
                provider: provider,
                apiKey: apiKey,
                baseUrl: finalBaseUrl,
                model: finalModel
            };
            
            localStorage.setItem('vcook-ai-config', JSON.stringify(vCook.aiConfig));
            updateAIStatus();
            
            vCook.updateResponse('‚úÖ AIÈÖçÁΩÆÂ∑≤‰øùÂ≠òÔºÅÁé∞Âú®ÂèØ‰ª•‰ΩøÁî®Êô∫ËÉΩËèúË∞±Êé®ËçêÂíåËØ≠Èü≥ÁêÜËß£ÂäüËÉΩ„ÄÇ');
            vCook.speak('AIÈÖçÁΩÆÂ∑≤‰øùÂ≠ò');
        }
        
        async function testAIConnection() {
            if (!vCook.aiConfig.apiKey) {
                alert('ËØ∑ÂÖàËæìÂÖ•APIÂØÜÈí•');
                return;
            }
            
            try {
                vCook.updateResponse('üîÑ Ê≠£Âú®ÊµãËØïAIËøûÊé•...');
                const testResponse = await vCook.callAI('‰Ω†Â•ΩÔºåËØ∑ÁÆÄÂçïÂõûÂ§çÁ°ÆËÆ§ËøûÊé•Ê≠£Â∏∏');
                vCook.updateResponse('‚úÖ AIËøûÊé•ÊµãËØïÊàêÂäüÔºÅ\n\n' + testResponse);
                vCook.speak('AIËøûÊé•ÊµãËØïÊàêÂäü');
                updateAIStatus();
            } catch (error) {
                vCook.updateResponse('‚ùå AIËøûÊé•ÊµãËØïÂ§±Ë¥•Ôºö' + error.message);
                vCook.speak('AIËøûÊé•ÊµãËØïÂ§±Ë¥•');
                console.error('AIËøûÊé•ÊµãËØïÂ§±Ë¥•:', error);
            }
        }
        
        function clearAIConfig() {
            if (confirm('Á°ÆÂÆöË¶ÅÊ∏ÖÈô§AIÈÖçÁΩÆÂêóÔºüËøôÂ∞ÜÂà†Èô§ÊâÄÊúâ‰øùÂ≠òÁöÑËÆæÁΩÆ„ÄÇ')) {
                vCook.aiConfig = {
                    provider: 'openai',
                    apiKey: '',
                    baseUrl: 'https://api.openai.com/v1',
                    model: 'gpt-3.5-turbo'
                };
                localStorage.removeItem('vcook-ai-config');
                loadAIConfigToForm();
                updateAIStatus();
                vCook.updateResponse('üóëÔ∏è AIÈÖçÁΩÆÂ∑≤Ê∏ÖÈô§ÔºåÂ∑≤ÂàáÊç¢Âà∞Âü∫Á°ÄÂäüËÉΩÊ®°Âºè„ÄÇ');
                vCook.speak('AIÈÖçÁΩÆÂ∑≤Ê∏ÖÈô§');
            }
        }
        
        function updateAIStatus() {
            const statusElement = document.getElementById('aiStatus');
            const formElement = document.getElementById('aiConfigForm');
            
            if (vCook.aiConfig.apiKey) {
                statusElement.className = 'ai-status connected';
                statusElement.innerHTML = `
                    <span>üü¢ AIÂ∑≤ËøûÊé• (${vCook.aiConfig.provider})</span>
                    <button class="btn btn-secondary" onclick="toggleConfigForm()">ÁÆ°ÁêÜ</button>
                `;
            } else {
                statusElement.className = 'ai-status disconnected';
                statusElement.innerHTML = `
                    <span>üî¥ AIÊú™ÈÖçÁΩÆ</span>
                    <button class="btn btn-secondary" onclick="toggleConfigForm()">ÈÖçÁΩÆ</button>
                `;
            }
        }
        
        function toggleConfigForm() {
            const form = document.getElementById('aiConfigForm');
            const isVisible = form.style.display === 'block';
            form.style.display = isVisible ? 'none' : 'block';
            
            if (!isVisible) {
                loadAIConfigToForm();
            }
        }
        
        // È°µÈù¢Âä†ËΩΩÊó∂Êõ¥Êñ∞AIÁä∂ÊÄÅ
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                updateAIStatus();
                // ÈªòËÆ§ÊòæÁ§∫AIÈÖçÁΩÆÈù¢Êùø
                document.getElementById('aiConfigPanel').style.display = 'block';
            }, 1000);
        });
    </script>
</body>
</html>